---
name: 终端按钮功能优化
overview: 在 Claude 和 Codex 供应商列表中添加打开终端按钮，使用首选终端设置，并隐藏原有终端按钮
todos:
  - id: adjust-provider-actions
    content: 调整 ProviderActions 组件按钮布局，将终端按钮移到启用按钮左侧并限制 claude/codex 显示
    status: completed
  - id: remove-old-terminal-btn
    content: 移除 ProviderActions 中原有操作按钮组中的终端按钮
    status: completed
    dependencies:
      - adjust-provider-actions
  - id: verify-terminal-flow
    content: 验证终端打开流程正常工作，确认工作目录和首选终端设置生效
    status: completed
    dependencies:
      - remove-old-terminal-btn
---

## 需求概述

在供应商列表中为 claude 和 codex 应用添加终端打开功能，调整按钮位置并隐藏 claude 界面原有的终端按钮。

## 核心功能

1. **终端按钮位置调整**：在"启用"按钮左侧添加终端打开按钮（仅对 claude 和 codex 显示）
2. **终端启动逻辑**：使用设置中配置的`首选终端`，如不可用则回退到系统默认终端
3. **隐藏原有终端按钮**：移除 ProviderActions 中原有在操作按钮组中的终端按钮
4. **工作目录**：使用首页中间设置的工作目录作为终端启动目录

## 技术栈

- 前端：React + TypeScript + Tailwind CSS
- 后端：Rust (Tauri)
- 状态管理：React Query

## 实现方案

### 修改策略

1. **ProviderActions.tsx**：调整按钮布局，将终端按钮移到"启用"按钮左侧，并限制仅在 claude 和 codex 应用显示；移除原有操作按钮组中的终端按钮
2. **后端命令**：`open_provider_terminal` 已完整实现首选终端检测和回退逻辑，无需修改

### 关键实现点

- 终端按钮显示条件：`appId === "claude" || appId === "codex"`
- 按钮顺序：终端按钮 → 启用/添加按钮 → 其他操作按钮
- 终端启动流程已存在，通过 `providersApi.openTerminal` 调用后端命令

### 文件变更

- `src/components/providers/ProviderActions.tsx` - 调整按钮布局和显示逻辑